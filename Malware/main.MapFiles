// svchost.exe - main.MapFiles 함수
// Ghidra 디컴파일 분석

void main.MapFiles(undefined8 param_1, undefined8 param_2) {
    uStack0000000000000008 = param_1;               // 탐색할 경로 포인터
                                                    // param_2: 경로 길이
    
                    /* C:/Project/rs/enc/enc.go:110 */
    while (&stack0x00000000 <= *(undefined1 **)(unaff_R14 + 0x10)) {
                    /* C:/Project/rs/enc/enc.go:110 */
        runtime.morestack_noctxt();
    }
    
                    /* C:/Project/rs/enc/enc.go:111 */
    local_40[0] = 0;                                // 파일 목록 초기화
    
                    /* C:/Project/rs/enc/enc.go:113 */
    local_28 = main.MapFiles.func1;                 // 함수 포인터 설정
    local_20 = local_40;                            // 파일 목록 포인터
    
                    /* C:/Project/rs/enc/enc.go:115 */
    path/filepath.WalkDir(uStack0000000000000008,   // 시작 경로 [ Param ]
                         param_2,                   // 경로 길이
                         &local_28);                // 위에서 정의한 함수 (각 파일/디렉터리마다 호출)
    
                    /* C:/Project/rs/enc/enc.go:123 */
    if (extraout_RAX != 0) {                        // WalkDir 실행 중 에러 발생 시 IF 분기 시작 
                    /* C:/Project/rs/enc/enc.go:124 */
        auVar1 = (**(code **)(extraout_RAX + 0x18))(extraout_RBX);
        runtime.convTstring(auVar1._0_8_, auVar1._8_8_);
        
        local_18[0] = &datatype.String.string;
        
                    /* C:/Program Files/Go/src/fmt/print.go:314 */
        fmt.Fprintln(&go:itab.*os.File, io.Writer, os.Stdout, local_18, 1, 1);  // 에러 출력
    }
    
                    /* C:/Project/rs/enc/enc.go:127 */
    return;
}
